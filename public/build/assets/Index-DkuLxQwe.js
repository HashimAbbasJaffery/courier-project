import{g as e,r as a,y as l,D as t,z as s,o as n,n as d,c as o,a as i,A as r,d as c,E as m,b as u,k as v,B as p,f as b,F as y,m as f,q as g,C as _,t as h,p as k}from"./vendor-CEpDKWGO.js";import{a as w}from"./data-C-1G2k3o.js";import{_ as x}from"./app-DKrcNuQA.js";import"./ui-B1kR6gEw.js";const P={class:"container-xxl container-p-y flex-grow-1"},M={class:"card position-relative"},D={class:"card mb-4 p-3"},V={id:"filterForm"},C={class:"row"},U={class:"col-md-3"},N={key:0,class:"loading-overlay"},S={class:"table-responsive text-nowrap"},T={id:"myTable",class:"table table-bordered"},A={style:{display:"flex",gap:"10px"}},q=["href"],I=["onClick"],E=["onClick"],R={style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",height:"100vh"}},O={class:"modal fade",id:"deleteMaterialModal",tabindex:"-1","aria-hidden":"true"},Y={class:"modal-dialog modal-md modal-simple modal-delete-user"},F={class:"modal-content"},B={class:"modal-body"},j={method:"POST",class:"text-center"},L={class:"modal fade",id:"editMaterialModal",tabindex:"-1","aria-hidden":"true"},z={class:"modal-dialog modal-lg modal-simple modal-edit-user"},G={class:"modal-content"},H={class:"modal-body p-0"},W={method:"POST",class:"row g-5"},J={class:"col-12"},K={class:"form-floating form-floating-outline"},Q=["value"],X={class:"col-12 text-center"},Z={class:"modal fade",id:"addMaterialModal",tabindex:"-1","aria-hidden":"true"},ee={class:"modal-dialog modal-lg modal-simple modal-edit-user"},ae={class:"modal-content"},le={class:"modal-body p-0"},te={method:"POST",class:"row g-5"},se={class:"col-12"},ne={class:"form-floating form-floating-outline"},de={class:"modal fade",id:"updatePaymentModal",tabindex:"-1","aria-hidden":"true"},oe={class:"modal-dialog",style:{"max-width":"95%",width:"95%"}},ie={class:"modal-content",style:{padding:"30px"}},re={class:"modal-body p-0"},ce={class:"col-md-4"},me={class:"form-floating form-floating-outline"},ue={class:"col-md-8"},ve={class:"form-floating form-floating-outline"},pe=["placeholder"],be={class:"col-12 text-center"},ye=["disabled"],fe={key:0,class:"spinner-border spinner-border-sm me-2"},ge={key:0,class:"row g-4"},_e={class:"col-12"},he={class:"card bg-light"},ke={class:"card-body"},we={class:"row g-3"},xe={class:"col-md-6"},Pe={class:"mb-0"},Me={class:"col-md-6"},De={class:"mb-0"},Ve={class:"col-md-6"},Ce={class:"mb-0"},Ue={class:"col-md-6"},Ne={class:"mb-0"},Se={class:"col-md-6"},Te={class:"mb-0"},Ae={class:"col-md-6"},qe={class:"mb-0"},Ie={class:"col-md-6"},Ee={class:"mb-0"},Re={class:"col-md-6"},Oe={class:"mb-0"},Ye={class:"col-md-6"},Fe={class:"mb-0"},$e={class:"col-md-6"},Be={class:"mb-0"},je={class:"badge bg-primary"},Le={key:0,class:"col-12"},ze={class:"mb-0"},Ge={class:"col-12"},He={class:"card"},We={class:"card-body"},Je={class:"table-responsive d-none d-md-block"},Ke={class:"table table-bordered align-middle",id:"paymentItemsTable"},Qe=["onUpdate:modelValue"],Xe=["onUpdate:modelValue"],Ze=["value"],ea=["onUpdate:modelValue"],aa=["onUpdate:modelValue"],la=["onUpdate:modelValue"],ta=["onUpdate:modelValue"],sa=["value"],na=["value"],da=["value"],oa=["onClick","disabled"],ia={class:"table-totals"},ra={class:"totals-label"},ca={class:"totals-value"},ma={class:"totals-value"},ua={class:"totals-value"},va={class:"totals-value"},pa={class:"totals-label"},ba={class:"d-block d-md-none"},ya={class:"d-flex align-items-center justify-content-between mb-2"},fa={class:"mb-0"},ga=["onClick","disabled"],_a={class:"row g-2"},ha={class:"col-6"},ka=["onUpdate:modelValue"],wa=["value"],xa={class:"col-12"},Pa=["onUpdate:modelValue"],Ma={class:"col-6"},Da=["onUpdate:modelValue"],Va={class:"col-6"},Ca=["onUpdate:modelValue"],Ua={class:"col-6"},Na=["onUpdate:modelValue"],Sa=["value"],Ta={class:"col-6"},Aa=["value"],qa={class:"col-12"},Ia={class:"alert alert-info mb-0 py-2"},Ea={class:"row mt-4"},Ra={class:"col-12 text-center"},Oa=["disabled"],Ya={key:0,class:"spinner-border spinner-border-sm me-2"},Fa={key:1,class:"row g-4"},$a={class:"col-12"},Ba={class:"alert alert-info text-center"},ja={key:0,class:"spinner-border spinner-border-sm me-2"},La={key:1},za={key:2},Ga={key:3},Ha={class:"modal fade",id:"makePaymentModal",tabindex:"-1","aria-hidden":"true"},Wa={class:"modal-dialog modal-md"},Ja={class:"modal-content border-0 shadow-lg"},Ka={class:"modal-body pt-4"},Qa={class:"form-group mb-4"},Xa=["value"],Za={key:0,class:"form-group mb-4"},el={key:1,class:"form-group mb-4"},al={class:"input-group input-group-lg"},ll={class:"d-flex gap-3 pt-3"},tl=["disabled"],sl={key:0,class:"ri-check-line me-2"},nl={key:1,class:"ri-loader-4-line me-2 animate-spin"},dl={key:2},ol={key:3},il={key:4},rl=x(e({__name:"Index",setup(e){const x=a([]),rl=a([]),cl=a([]),ml=a(""),ul=a(""),vl=a(null),pl=a(null),bl=a(!0),yl=a(!1),fl=a(!1),gl=a(!1),_l=l({dateRange:""});const hl=a(""),kl=a("order_id"),wl=a(null),xl=a(!1),Pl=a(!1),Ml=a({date:"",vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_amount:0}),Dl=a([]),Vl=a(!1);t(()=>{const e=Ul(Ml.value.material_id);return(Ml.value.item_price||0)-(Ml.value.purchase_cost||0)-e});const Cl=t(()=>cl.value?.data&&rl.value?.data&&x.value?.data),Ul=e=>{if(!cl.value?.data||!Array.isArray(cl.value.data))return 0;const a=cl.value.data.find(a=>a.id===e);return a?a.price:0};function Nl(){_l.dateRange=function(){const e=new Date,a=new Date;a.setDate(e.getDate()-7);const l=e=>e.toISOString().split("T")[0];return`${l(a)} - ${l(e)}`}(),Ol()}const Sl=()=>{const e={date:"",id:Dl.value.length+1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:""};Dl.value.push(e)},Tl=e=>{Dl.value=Dl.value.filter(a=>a.id!==e),Dl.value.forEach((e,a)=>{e.id=a+1}),0===Dl.value.length&&Sl()},Al=t(()=>Dl.value.reduce((e,a)=>{const l=Ul(a.material_id);return e+((a.item_price||0)-(a.purchase_cost||0)-l)},0));s([()=>Ml.value.item_price,()=>Ml.value.purchase_cost,()=>Ml.value.material_id],()=>{},{deep:!0});const ql=a({vendor_id:"",amount:0,date:(new Date).toISOString().split("T")[0]}),Il=a(!1),El=async()=>{try{Il.value=!0;if(200===(await w.post(route("payment.create",{vendor:ql.value.vendor_id}),{amount:ql.value.amount,date:ql.value.date})).status){Rl(),ql.value={vendor_id:"",amount:0,date:(new Date).toISOString().split("T")[0]};const e=document.getElementById("makePaymentModal");if(e){const a=bootstrap.Modal.getInstance(e);a&&a.hide()}await Ol()}}catch(e){alert("Payment submission failed. Please try again.")}finally{Il.value=!1}},Rl=()=>{const e=document.createElement("div");e.className="modal fade",e.id="successPaymentModal",e.innerHTML='\n        <div class="modal-dialog modal-sm">\n            <div class="modal-content border-0 shadow-lg">\n                <div class="modal-header border-0 pb-0 text-center">\n                    <div class="w-100">\n                        <div class="success-icon mx-auto mb-3">\n                            <i class="ri-check-line"></i>\n                        </div>\n                        <h4 class="modal-title mb-2 fw-semibold text-success">Payment Successful!</h4>\n                        <p class="text-muted mb-0 small">Your payment has been processed</p>\n                    </div>\n                </div>\n                <div class="modal-body text-center pt-0">\n                    <div class="success-message">\n                        <i class="ri-money-dollar-circle-line text-success me-2"></i>\n                        <span class="fw-medium">Payment has been created successfully!</span>\n                    </div>\n                </div>\n                <div class="modal-footer border-0 justify-content-center pt-0">\n                    <button type="button" class="btn btn-success btn-lg px-4 shadow-sm" data-bs-dismiss="modal">\n                        <i class="ri-check-line me-2"></i>Great!\n                    </button>\n                </div>\n            </div>\n        </div>\n    ',document.body.appendChild(e);new bootstrap.Modal(e).show(),e.addEventListener("hidden.bs.modal",()=>{document.body.removeChild(e)})};async function Ol(e={}){try{yl.value=!0;const a={};if(_l.dateRange&&_l.dateRange.includes(" - ")){const[e,l]=_l.dateRange.split(" - ");a.date_from=e,a.date_to=l}Object.assign(a,e);const l=await w.get(route("vendors.get"),{params:a});x.value=l.data}catch(a){}finally{yl.value=!1}}async function Yl(e){e.preventDefault();try{201===(await w.post(route("vendor.create"),{name:ml.value,price:ul.value})).status&&(closeCreateModal.click(),ml.value="",await Ol())}catch(a){}}async function Fl(e){e.preventDefault();try{200===(await w.post(route("vendor.update",{id:pl.value}),{name:edit_vendor_name.value})).status&&(cancelMaterialButton.click(),pl.value=null,await Ol())}catch(a){}}async function $l(e){e.preventDefault();try{200===(await w.post(route("vendor.delete",{id:vl.value}))).status&&(vl.value=null,cancelModalButton.click(),await Ol())}catch(a){}}const Bl=async e=>{if(e.preventDefault(),hl.value.trim())try{xl.value=!0,Pl.value=!1;const e=await w.get(`/api/shipments/search?field=${kl.value}&query=${encodeURIComponent(hl.value.trim())}`),a=e.data?.data?.items||[];e.data.success&&e.data.data?(wl.value=e.data.data,Pl.value=!0,Ml.value={vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",advance_payment:0},Dl.value=[],a.length>0?a.forEach(e=>{Dl.value.push({id:e.id,date:e.created_at?.split("T")[0]||"",vendor_id:e.vendor_id||"",platform_id:e.platform_id||"",item_name:e.item_name||"",purchase_cost:e.purchase_cost||0,item_price:e.item_price||0,material_id:e.material_id||"",total_amount:e.total_amount||0})}):Dl.value=[{date:"",id:1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",advance_payment:0}]):(alert("No payment/shipment found with the provided details. Please try again."),wl.value=null,Pl.value=!1)}catch(a){404===a.response?.status?alert("No shipment found with the provided details. Please try again."):alert("Error searching for payment. Please try again."),wl.value=null,Pl.value=!1}finally{xl.value=!1}else alert("Please enter a search term")},jl=async e=>{e.preventDefault();const a=e=>null==e||""===e;if(Dl.value.filter(e=>a(e.vendor_id)||a(e.item_name)||a(e.purchase_cost)||a(e.item_price)||a(e.material_id)).length>0)alert("Please fill in all required fields for all items");else try{Vl.value=!0;const e=Dl.value.map(e=>w.post("/api/shipments/payment/update",{date:e.date||(new Date).toISOString().split("T")[0],id:e.id||null,shipment_id:wl.value.id,vendor_id:e.vendor_id,platform_id:e.platform_id,item_name:e.item_name,purchase_cost:e.purchase_cost,item_price:e.item_price,material_id:e.material_id,total_amount:e.total_amount})),a=await Promise.all(e);if(a.every(e=>e.data.success)){alert(`Payment details updated successfully for ${Dl.value.length} item(s)!`),Pl.value=!1,wl.value=null,hl.value="";const e=bootstrap.Modal.getInstance(document.getElementById("updatePaymentModal"));e&&e.hide()}else alert("Some items failed to update. Please try again.")}catch(l){l.response?.data?.message?alert("Error updating payment: "+l.response.data.message):alert("Error updating payment. Please try again.")}finally{Vl.value=!1}},Ll=()=>{hl.value="",kl.value="order_id",wl.value=null,Pl.value=!1,Ml.value={vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",advance_payment:0},Dl.value=[]},zl=e=>new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),Gl=()=>{const e=$("#myTable").DataTable();$.fn.DataTable.isDataTable("#myTable")&&e.destroy(),d(()=>{$("#myTable").DataTable({pageLength:10,lengthMenu:[[10,25,50,-1],[10,25,50,"All"]]})})};n(async()=>{await Ol(),await async function(){try{gl.value=!0;const e=await w.get(route("platforms.get"));rl.value=e.data}catch(e){}finally{gl.value=!1}}(),await async function(){try{fl.value=!0;const e=await w.get(route("materials.get"));cl.value=e.data}catch(e){}finally{fl.value=!1}}(),Gl(),bl.value=!1;const e=document.getElementById("updatePaymentModal");e&&e.addEventListener("hidden.bs.modal",Ll),d(()=>{$("#daterange").daterangepicker({locale:{format:"YYYY-MM-DD"},startDate:moment().subtract(7,"days"),endDate:moment()},function(e,a){_l.dateRange=`${e.format("YYYY-MM-DD")} - ${a.format("YYYY-MM-DD")}`,Ol()})})});let Hl=!1;return s(x,()=>{Hl?Gl():Hl=!0}),s(_l,async e=>{e.dateRange&&await Ol()},{deep:!0}),(e,a)=>(i(),o(y,null,[r(c("div",P,[c("div",M,[a[14]||(a[14]=u('<div class="card-header d-flex align-items-center justify-content-between ps-0 pb-0" data-v-4e1da2c8><h5 class="card-header" data-v-4e1da2c8>Manage Vendors</h5><div class="d-flex gap-2" data-v-4e1da2c8><button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addMaterialModal" data-v-4e1da2c8>Add Vendor</button><button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#makePaymentModal" data-v-4e1da2c8>Make Payment</button><button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#updatePaymentModal" data-v-4e1da2c8>Update Payment</button></div></div>',1)),c("div",D,[c("form",V,[c("div",C,[c("div",U,[a[9]||(a[9]=c("label",null,[c("strong",null,"Date Range:")],-1)),r(c("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>_l.dateRange=e),name:"daterange",id:"daterange",class:"form-control"},null,512),[[p,_l.dateRange]])]),c("div",{class:"col-md-3 d-flex align-items-end"},[c("button",{onClick:Nl,type:"button",class:"btn btn-outline-secondary"},a[10]||(a[10]=[c("i",{class:"ri-refresh-line me-2"},null,-1),b(" Reset Date Filter ",-1)]))])])])]),yl.value?(i(),o("div",N,a[11]||(a[11]=[c("div",{class:"loading-spinner"},null,-1),c("div",{class:"mt-3 text-muted"},"Fetching data...",-1)]))):v("",!0),c("div",S,[c("table",T,[a[13]||(a[13]=c("thead",null,[c("tr",null,[c("th",null,"No#"),c("th",null,"Vendor Name"),c("th",null,"Total Payment"),c("th",null,"Action")])],-1)),c("tbody",null,[(i(!0),o(y,null,f(x.value.data,(l,t)=>(i(),o("tr",{key:l.id},[c("td",null,h(t+1),1),c("td",null,h(l.name),1),c("td",null,h(l.toPay),1),c("td",A,[c("a",{href:e.route("vendors.show",{vendor:l.id}),class:"btn btn-sm btn-info"},a[12]||(a[12]=[c("i",{class:"ri-eye-line me-1"},null,-1),b("View ",-1)]),8,q),c("button",{class:"btn btn-sm btn-warning editBtn",onClick:e=>pl.value=l.id,"data-bs-target":"#editMaterialModal","data-bs-toggle":"modal","data-id":"1"},"Edit",8,I),c("button",{class:"btn btn-sm btn-danger deleteBtn",onClick:e=>vl.value=l.id,"data-bs-toggle":"modal","data-bs-target":"#deleteMaterialModal","data-id":"1"},"Delete",8,E)])]))),128))])])])])],512),[[m,!bl.value]]),r(c("div",R,a[15]||(a[15]=[c("span",{class:"loader"},null,-1)]),512),[[m,bl.value]]),c("div",O,[c("div",Y,[c("div",F,[c("div",B,[a[17]||(a[17]=c("h4",{class:"text-center mb-4"},[b("Are you sure you want to delete "),c("span",{id:"delete_material_name"}),b("?")],-1)),c("form",j,[a[16]||(a[16]=c("input",{type:"hidden",name:"material_id",id:"delete_material_id"},null,-1)),c("button",{type:"submit",onClick:$l,name:"delete_material",class:"btn btn-danger me-3"},"Yes, Delete"),c("button",{type:"button",onClick:a[1]||(a[1]=e=>vl.value=null),id:"cancelModalButton",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel")])])])])]),c("div",L,[c("div",z,[c("div",G,[c("div",H,[a[20]||(a[20]=c("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1)),a[21]||(a[21]=c("div",{class:"text-center mb-6"},[c("h4",{class:"mb-2"},"Edit Packaging Material")],-1)),c("form",W,[a[19]||(a[19]=c("input",{type:"hidden",name:"material_id",id:"edit_material_id"},null,-1)),c("div",J,[c("div",K,[c("input",{type:"text",value:x.value.data?.filter(e=>e.id==pl.value)[0]?.name??"",name:"vendor_name",id:"edit_vendor_name",class:"form-control",placeholder:"Vendor Name",required:""},null,8,Q),a[18]||(a[18]=c("label",{for:"edit_vendor_name"},"Vendor Name",-1))])]),c("div",X,[c("button",{type:"submit",onClick:Fl,name:"update_material",id:"updateMaterialButton",class:"btn btn-primary me-3"},"Update"),c("button",{type:"button",onClick:a[2]||(a[2]=e=>pl.value=null),id:"cancelMaterialButton",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel")])])])])])]),c("div",Z,[c("div",ee,[c("div",ae,[c("div",le,[a[24]||(a[24]=c("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal"},null,-1)),a[25]||(a[25]=c("div",{class:"mb-6 text-center"},[c("h4",{class:"mb-2"},"Add Packaging Material")],-1)),c("form",te,[c("div",se,[c("div",ne,[r(c("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>ml.value=e),type:"text",name:"vendor_name",class:"form-control",placeholder:"Vendor Name",required:""},null,512),[[p,ml.value]]),a[22]||(a[22]=c("label",{for:"vendor_name"},"Name",-1))])]),c("div",{class:"col-12 text-center"},[c("button",{type:"submit",name:"add_material",onClick:Yl,class:"btn btn-primary me-3"},"Submit"),a[23]||(a[23]=c("button",{type:"button",id:"closeCreateModal",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1))])])])])])]),c("div",de,[c("div",oe,[c("div",ie,[c("div",re,[c("button",{type:"button",class:"btn-close",onClick:Ll,"data-bs-dismiss":"modal"}),a[66]||(a[66]=c("div",{class:"mb-6 text-center"},[c("h4",{class:"mb-2"},"Update Payment"),c("p",{class:"text-muted"},"Search and update existing payment records")],-1)),c("form",{onSubmit:g(Bl,["prevent"]),class:"row g-4 mb-4"},[c("div",ce,[c("div",me,[r(c("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>kl.value=e),class:"form-select",required:""},a[26]||(a[26]=[c("option",{value:"order_id"},"Order ID",-1),c("option",{value:"tracking_number"},"Tracking Number",-1),c("option",{value:"consignee_name"},"Customer Name",-1),c("option",{value:"consignee_phone"},"Phone Number",-1)]),512),[[_,kl.value]]),a[27]||(a[27]=c("label",null,"Search Field",-1))])]),c("div",ue,[c("div",ve,[r(c("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>hl.value=e),type:"text",class:"form-control",placeholder:"Enter "+("order_id"===kl.value?"Order ID":"tracking_number"===kl.value?"Tracking Number":"consignee_name"===kl.value?"Customer Name":"Phone Number"),required:""},null,8,pe),[[p,hl.value]]),c("label",null,h("order_id"===kl.value?"Order ID":"tracking_number"===kl.value?"Tracking Number":"consignee_name"===kl.value?"Customer Name":"Phone Number"),1)])]),c("div",be,[c("button",{type:"submit",class:"btn btn-warning me-3",disabled:xl.value},[xl.value?(i(),o("span",fe)):v("",!0),b(" "+h(xl.value?"Searching...":"Search Payment"),1)],8,ye),c("button",{type:"button",onClick:Ll,class:"btn btn-outline-secondary me-2"},"Reset"),a[28]||(a[28]=c("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1))])],32),Pl.value&&wl.value&&Cl.value?(i(),o("div",ge,[c("div",_e,[c("div",he,[a[40]||(a[40]=c("div",{class:"card-header"},[c("h6",{class:"mb-0"},[c("i",{class:"ri-information-line me-2"}),b("Found Order Details")])],-1)),c("div",ke,[c("div",we,[c("div",xe,[a[29]||(a[29]=c("label",{class:"form-label fw-bold"},"Order ID:",-1)),c("p",Pe,h(wl.value.order_id||"N/A"),1)]),c("div",Me,[a[30]||(a[30]=c("label",{class:"form-label fw-bold"},"Tracking Number:",-1)),c("p",De,h(wl.value.tracking_number||"N/A"),1)]),c("div",Ve,[a[31]||(a[31]=c("label",{class:"form-label fw-bold"},"Customer Name:",-1)),c("p",Ce,h(wl.value.consignee_name||"N/A"),1)]),c("div",Ue,[a[32]||(a[32]=c("label",{class:"form-label fw-bold"},"Phone Number:",-1)),c("p",Ne,h(wl.value.consignee_phone||"N/A"),1)]),c("div",Se,[a[33]||(a[33]=c("label",{class:"form-label fw-bold"},"Destination City:",-1)),c("p",Te,h(wl.value.destination_city||"N/A"),1)]),c("div",Ae,[a[34]||(a[34]=c("label",{class:"form-label fw-bold"},"COD Amount:",-1)),c("p",qe,h(wl.value.cod_amount||"N/A"),1)]),c("div",Ie,[a[35]||(a[35]=c("label",{class:"form-label fw-bold"},"Shipment Type:",-1)),c("p",Ee,h(wl.value.shipment_type||"N/A"),1)]),c("div",Re,[a[36]||(a[36]=c("label",{class:"form-label fw-bold"},"Weight:",-1)),c("p",Oe,h(wl.value.weight?`${wl.value.weight} kg`:"N/A"),1)]),c("div",Ye,[a[37]||(a[37]=c("label",{class:"form-label fw-bold"},"No. of Pieces:",-1)),c("p",Fe,h(wl.value.no_of_pieces||"N/A"),1)]),c("div",$e,[a[38]||(a[38]=c("label",{class:"form-label fw-bold"},"Status:",-1)),c("p",Be,[c("span",je,h(wl.value.status||"N/A"),1)])]),wl.value.consignee_address?(i(),o("div",Le,[a[39]||(a[39]=c("label",{class:"form-label fw-bold"},"Delivery Address:",-1)),c("p",ze,h(wl.value.consignee_address),1)])):v("",!0)])])])]),c("div",Ge,[c("div",He,[c("div",{class:"card-header d-flex align-items-center justify-content-between"},[a[41]||(a[41]=c("h6",{class:"mb-0"},[c("i",{class:"ri-money-dollar-circle-line me-2"}),b("Update Payment Details")],-1)),c("button",{type:"button",onClick:Sl,class:"btn btn-sm btn-success"},"+")]),c("div",We,[c("form",{onSubmit:g(jl,["prevent"])},[c("div",Je,[c("table",Ke,[c("thead",{class:"table-light"},[c("tr",null,[a[42]||(a[42]=c("th",null,"Date",-1)),a[43]||(a[43]=c("th",null,"Vendor",-1)),a[44]||(a[44]=c("th",null,"Product Name",-1)),a[45]||(a[45]=c("th",null,"Cost",-1)),a[46]||(a[46]=c("th",null,"Selling",-1)),a[47]||(a[47]=c("th",null,"Packaging Material",-1)),a[48]||(a[48]=c("th",null,"Total Amount",-1)),a[49]||(a[49]=c("th",null,"Profit",-1)),c("th",{style:{width:"64px"}},[c("button",{type:"button",class:"btn btn-sm btn-success",onClick:Sl},"+")])])]),c("tbody",null,[(i(!0),o(y,null,f(Dl.value,e=>(i(),o("tr",{key:e.id},[c("td",null,[r(c("input",{type:"date","onUpdate:modelValue":a=>e.date=a,class:"form-control",required:""},null,8,Qe),[[p,e.date]])]),c("td",null,[r(c("select",{"onUpdate:modelValue":a=>e.vendor_id=a,class:"form-select",required:""},[a[50]||(a[50]=c("option",{value:""},"Select Vendor",-1)),(i(!0),o(y,null,f(x.value.data||[],e=>(i(),o("option",{key:e.id,value:e.id},h(e.name),9,Ze))),128))],8,Xe),[[_,e.vendor_id]])]),c("td",null,[r(c("input",{type:"text","onUpdate:modelValue":a=>e.item_name=a,class:"form-control",required:""},null,8,ea),[[p,e.item_name]])]),c("td",null,[r(c("input",{type:"number",step:"0.01","onUpdate:modelValue":a=>e.purchase_cost=a,class:"form-control",required:""},null,8,aa),[[p,e.purchase_cost,void 0,{number:!0}]])]),c("td",null,[r(c("input",{type:"number",step:"0.01","onUpdate:modelValue":a=>e.item_price=a,class:"form-control",required:""},null,8,la),[[p,e.item_price,void 0,{number:!0}]])]),c("td",null,[r(c("select",{"onUpdate:modelValue":a=>e.material_id=a,class:"form-select",required:""},[a[51]||(a[51]=c("option",{value:""},"Select Material",-1)),(i(!0),o(y,null,f(cl.value.data||[],e=>(i(),o("option",{key:e.id,value:e.id},h(e.name)+" ("+h(e.price)+") ",9,sa))),128))],8,ta),[[_,e.material_id]])]),c("td",null,[c("input",{type:"number",readonly:"",value:e.item_price,step:"0.01",class:"form-control"},null,8,na)]),c("td",null,[c("input",{type:"number",value:(e.item_price||0)-(e.purchase_cost||0)-Ul(e.material_id),class:"form-control",readonly:""},null,8,da)]),c("td",null,[c("button",{type:"button",class:"btn btn-sm btn-danger",onClick:a=>Tl(e.id),disabled:1===Dl.value.length},"-",8,oa)])]))),128)),c("tr",ia,[a[52]||(a[52]=c("td",{class:"totals-label"},[c("strong",null,"Total")],-1)),c("td",ra,[c("strong",null,h(Dl.value.length)+" Items",1)]),a[53]||(a[53]=c("td",{class:"totals-label"},[c("strong",null,"â€”")],-1)),c("td",ca,[c("strong",null,h(zl(Dl.value.reduce((e,a)=>e+(a.purchase_cost||0),0))),1)]),c("td",ma,[c("strong",null,h(zl(Dl.value.reduce((e,a)=>e+Ul(a.material_id),0))),1)]),c("td",ua,[c("strong",null,h(zl(Dl.value.reduce((e,a)=>e+(a.item_price||0),0))),1)]),c("td",va,[c("strong",{class:k({"text-danger":Al.value<0,"text-success":Al.value>0})},h(zl(Al.value)),3)]),c("td",pa,[c("strong",null,h(Dl.value.reduce((e,a)=>e+(a.item_price||0),0)>0?(Al.value/Dl.value.reduce((e,a)=>e+(a.item_price||0),0)*100).toFixed(1):0)+"%",1)])])])])]),c("div",ba,[(i(!0),o(y,null,f(Dl.value,e=>(i(),o("div",{key:"m-"+e.id,class:"item-card mb-3 p-3 border rounded"},[c("div",ya,[c("h6",fa,"Item #"+h(e.id),1),c("button",{type:"button",onClick:a=>Tl(e.id),class:"btn btn-sm btn-outline-danger",disabled:1===Dl.value.length},a[54]||(a[54]=[c("i",{class:"ri-delete-bin-line"},null,-1)]),8,ga)]),c("div",_a,[c("div",ha,[a[56]||(a[56]=c("label",{class:"form-label small"},"Vendor",-1)),r(c("select",{"onUpdate:modelValue":a=>e.vendor_id=a,class:"form-select form-select-sm",required:""},[a[55]||(a[55]=c("option",{value:""},"Select Vendor",-1)),(i(!0),o(y,null,f(x.value.data||[],e=>(i(),o("option",{key:e.id,value:e.id},h(e.name),9,wa))),128))],8,ka),[[_,e.vendor_id]])]),c("div",xa,[a[57]||(a[57]=c("label",{class:"form-label small"},"Product Name",-1)),r(c("input",{"onUpdate:modelValue":a=>e.item_name=a,type:"text",class:"form-control form-control-sm",required:""},null,8,Pa),[[p,e.item_name]])]),c("div",Ma,[a[58]||(a[58]=c("label",{class:"form-label small"},"Cost",-1)),r(c("input",{"onUpdate:modelValue":a=>e.purchase_cost=a,type:"number",step:"0.01",class:"form-control form-control-sm",required:""},null,8,Da),[[p,e.purchase_cost]])]),c("div",Va,[a[59]||(a[59]=c("label",{class:"form-label small"},"Selling",-1)),r(c("input",{"onUpdate:modelValue":a=>e.item_price=a,type:"number",step:"0.01",class:"form-control form-control-sm",required:""},null,8,Ca),[[p,e.item_price]])]),c("div",Ua,[a[61]||(a[61]=c("label",{class:"form-label small"},"Packaging Material",-1)),r(c("select",{"onUpdate:modelValue":a=>e.material_id=a,class:"form-select form-select-sm",required:""},[a[60]||(a[60]=c("option",{value:""},"Select Material",-1)),(i(!0),o(y,null,f(cl.value.data||[],e=>(i(),o("option",{key:e.id,value:e.id},h(e.name)+" ("+h(e.price)+") ",9,Sa))),128))],8,Na),[[_,e.material_id]])]),c("div",Ta,[a[62]||(a[62]=c("label",{class:"form-label small"},"Total Amount",-1)),c("input",{value:e.total_amount,type:"number",step:"0.01",class:"form-control form-control-sm"},null,8,Aa)]),c("div",qa,[c("div",Ia,[a[63]||(a[63]=c("strong",null,"Profit:",-1)),b(" "+h(zl((e.item_price||0)-(e.purchase_cost||0)-Ul(e.material_id))),1)])])])]))),128)),c("div",{class:"text-center mt-3"},[c("button",{type:"button",onClick:Sl,class:"btn btn-success"},a[64]||(a[64]=[c("i",{class:"ri-add-line me-1"},null,-1),b("Add Item ",-1)]))])]),c("div",Ea,[c("div",Ra,[c("button",{type:"submit",class:"btn btn-warning me-3",disabled:Vl.value},[Vl.value?(i(),o("span",Ya)):v("",!0),b(" "+h(Vl.value?"Updating...":"Update Payment"),1)],8,Oa),a[65]||(a[65]=c("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"Cancel",-1))])])],32)])])])])):v("",!0),Pl.value&&wl.value&&!Cl.value?(i(),o("div",Fa,[c("div",$a,[c("div",Ba,[fl.value||gl.value?(i(),o("div",ja)):v("",!0),fl.value?(i(),o("span",La,"Loading materials...")):gl.value?(i(),o("span",za,"Loading platforms...")):(i(),o("span",Ga,"Loading payment form data..."))])])])):v("",!0)])])])]),c("div",Ha,[c("div",Wa,[c("div",Ja,[a[76]||(a[76]=u('<div class="modal-header border-0 pb-0" data-v-4e1da2c8><div class="d-flex align-items-center" data-v-4e1da2c8><div class="payment-icon me-3" data-v-4e1da2c8><i class="ri-money-dollar-circle-line text-primary" data-v-4e1da2c8></i></div><div data-v-4e1da2c8><h4 class="modal-title mb-1 fw-semibold text-dark" data-v-4e1da2c8>Make Payment</h4><p class="text-muted mb-0 small" data-v-4e1da2c8>Record a new payment transaction</p></div></div><button type="button" class="btn-close" data-bs-dismiss="modal" data-v-4e1da2c8></button></div>',1)),c("div",Ka,[c("form",{onSubmit:g(El,["prevent"])},[c("div",Qa,[a[68]||(a[68]=c("label",{for:"payment_vendor_id",class:"form-label fw-medium text-dark mb-2"},[c("i",{class:"ri-user-line me-2 text-muted"}),b("Select Vendor ")],-1)),r(c("select",{"onUpdate:modelValue":a[6]||(a[6]=e=>ql.value.vendor_id=e),id:"payment_vendor_id",class:k(["form-select form-select-lg border-2",ql.value.vendor_id?"border-success":"border-light"]),required:""},[a[67]||(a[67]=c("option",{value:""},"Choose a vendor from the list...",-1)),(i(!0),o(y,null,f(x.value.data,e=>(i(),o("option",{key:e.id,value:e.id,class:"py-2"},h(e.name),9,Xa))),128))],2),[[_,ql.value.vendor_id]]),a[69]||(a[69]=c("div",{class:"form-text text-muted small mt-1"},[c("i",{class:"ri-information-line me-1"}),b("Select the vendor you want to make payment to ")],-1))]),ql.value.vendor_id?(i(),o("div",Za,[a[70]||(a[70]=c("label",{for:"payment_date",class:"form-label fw-medium text-dark mb-2"},[c("i",{class:"ri-calendar-line me-2 text-muted"}),b("Payment Date ")],-1)),r(c("input",{"onUpdate:modelValue":a[7]||(a[7]=e=>ql.value.date=e),type:"date",id:"payment_date",class:k(["form-control form-control-lg border-2",ql.value.date?"border-success":"border-light"]),required:""},null,2),[[p,ql.value.date]]),a[71]||(a[71]=c("div",{class:"form-text text-muted small mt-1"},[c("i",{class:"ri-information-line me-1"}),b("Select the date for this payment ")],-1))])):v("",!0),ql.value.vendor_id?(i(),o("div",el,[a[73]||(a[73]=c("label",{for:"payment_amount",class:"form-label fw-medium text-dark mb-2"},[c("i",{class:"ri-money-dollar-circle-line me-2 text-muted"}),b("Payment Amount ")],-1)),c("div",al,[a[72]||(a[72]=c("span",{class:"input-group-text bg-light border-end-0"},[c("i",{class:"ri-currency-line text-muted"})],-1)),r(c("input",{"onUpdate:modelValue":a[8]||(a[8]=e=>ql.value.amount=e),type:"number",step:"0.01",id:"payment_amount",class:"form-control border-start-0 ps-0",placeholder:"0.00",required:""},null,512),[[p,ql.value.amount,void 0,{number:!0}]])]),a[74]||(a[74]=c("div",{class:"form-text text-muted small mt-1"},[c("i",{class:"ri-information-line me-1"}),b("Enter the payment amount in your local currency ")],-1))])):v("",!0),c("div",ll,[a[75]||(a[75]=c("button",{type:"button",class:"btn btn-outline-secondary btn-lg flex-fill","data-bs-dismiss":"modal"},[c("i",{class:"ri-close-line me-2"}),b("Cancel ")],-1)),c("button",{type:"submit",class:"btn btn-primary btn-lg flex-fill shadow-sm",disabled:!ql.value.vendor_id||!ql.value.amount||!ql.value.date||Il.value},[Il.value?(i(),o("i",nl)):(i(),o("i",sl)),ql.value.vendor_id&&ql.value.amount&&ql.value.date?Il.value?(i(),o("span",ol,"Processing Payment...")):(i(),o("span",il,"Submit Payment")):(i(),o("span",dl,"Fill Required Fields"))],8,tl)])],32)])])])])],64))}}),[["__scopeId","data-v-4e1da2c8"]]);export{rl as default};
