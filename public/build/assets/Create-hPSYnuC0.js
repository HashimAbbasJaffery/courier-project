import{c as e,a as l,d as a,t,F as n,m as o,p as s,g as i,r as d,D as c,o as u,n as r,z as m,A as p,k as v,b,E as y,e as _,C as h,f,G as g,B as S}from"./vendor-CEpDKWGO.js";import{_ as V}from"./Input-CaZEKWb-.js";import{a as k}from"./data-C-1G2k3o.js";import{_ as C}from"./app-CnPM6qvA.js";import"./ui-B1kR6gEw.js";const w={class:"form-floating form-floating-outline"},x=["name"],O={value:""},U=["selected","value"],P={__name:"DropdownMenu",props:{label:String,name:String,length:{default:6,type:Number,required:!0},nonvalueitem:String,items:Array,valueKey:String,itemKey:String,selected:String},emits:["update:modelValue"],setup(i,{emit:d}){const c=d;return(d,u)=>(l(),e("div",{class:s(`col-md-${i.length}`)},[a("div",w,[a("select",{onChange:u[0]||(u[0]=e=>c("update:modelValue",e.target.value)),name:i.name,class:"form-select",required:""},[a("option",O,t(i.nonvalueitem),1),(l(!0),e(n,null,o(i.items,a=>(l(),e("option",{selected:a[i.valueKey]==i.selected,key:a.id,value:a[i.valueKey]},t(a[i.itemKey]),9,U))),128))],40,x),a("label",null,t(i.label),1)])],2))}},I={class:"container-xxl container-p-y flex-grow-1"},D={class:"card mb-4 p-3"},N={class:"row g-6"},E={class:"row g-6"},T={class:"col-md-6"},A={class:"form-floating form-floating-outline form-floating-select2"},j=["value"],M={class:"row g-6"},R={key:0,class:"card mb-4 p-3 d-none d-md-block"},G={class:"table-responsive"},L={class:"table table-bordered align-middle",id:"itemsTable"},q=["onUpdate:modelValue"],K=["value"],F=["onUpdate:modelValue"],H=["onUpdate:modelValue"],X=["onUpdate:modelValue"],B=["onUpdate:modelValue"],Y=["value"],z=["value"],W=["value"],J=["onClick"],Q={class:"table-totals"},Z={class:"totals-label"},ee={class:"totals-value"},le={class:"totals-value"},ae={class:"totals-value"},te={class:"totals-value"},ne={class:"totals-value"},oe={class:"totals-label"},se={key:1,class:"card mb-4 p-3 d-block d-md-none"},ie={class:"item-card__header"},de=["onClick"],ce={class:"row g-2"},ue={class:"col-12"},re=["onUpdate:modelValue"],me=["value"],pe={class:"col-12"},ve=["onUpdate:modelValue"],be={class:"col-6"},ye=["onUpdate:modelValue"],_e={class:"col-6"},he=["onUpdate:modelValue"],fe={class:"col-12"},ge=["onUpdate:modelValue"],Se=["value"],Ve={class:"col-6"},ke=["value"],Ce={class:"col-6"},we=["value"],xe={class:"col-12"},Oe=["onUpdate:modelValue"],Ue={class:"pt-6",style:{display:"flex","justify-content":"flex-start"}},Pe=["disabled"],Ie={key:0,class:"loader small"},De={key:1},Ne={key:0,class:"fas fa-chevron-down ms-1"},Ee={key:1,class:"fas fa-chevron-up ms-1"},Te={key:0,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",height:"100vh"}},Ae=C(i({__name:"Create",setup(i){const C=document.createElement("script");C.src="https://kit.fontawesome.com/231b67747d.js",C.crossOrigin="anonymous",document.head.appendChild(C);const w=d([]),x=d(""),O={EXPRESS:[["OVERNIGHT","OVERNIGHT"],["ECONOMY","ECONOMY"]],LOGISTICS:[["OVERLAND LOGISTICS","OVERLAND LOGISTICS"]]},U=d([]),Ae=d("EXPRESS"),je=d(!1),Me=d([]),Re=d(!1),Ge=d([]),Le=d([]),qe=d(!0),Ke=d([{id:1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0}]),Fe=d({name:"",phone:"",address:""});d(null);const He=d(null),Xe=d({division:"",shipment_type:"",product_description:"",weight:"",pieces:"",advance_payment:0,payment_type:"COD",cod_amount:"",order_id:"",special_instructions:""});async function Be(){const e=await k.get(route("courier.cities",{courier:"leopard"}));w.value=e.data.data}async function $e(){const e=await k.get(route("platforms.get"));Le.value=e.data.data}async function Ye(){const e=await k.get(route("materials.get"));U.value=e.data.data}async function ze(){const e=await k.get(route("vendors.get"));Ge.value=e.data.data}const We=e=>{const l=U.value.find(l=>l.id===e);return l?l.price:0},Je=()=>{const e={id:Ke.value.length+1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0};Ke.value.push(e)},Qe=e=>{Ke.value=Ke.value.filter(l=>l.id!==e),Ke.value.forEach((e,l)=>{e.id=l+1}),0===Ke.value.length&&Je()},Ze=c(()=>Ke.value.reduce((e,l)=>e+(Number(l.purchase_cost)||0),0)),el=c(()=>Ke.value.reduce((e,l)=>e+(Number(l.item_price)||0),0)),ll=c(()=>Ke.value.reduce((e,l)=>e+We(l.material_id),0)),al=c(()=>Ke.value.reduce((e,l)=>e+(Number(l.item_price)||0),0)),tl=c(()=>Ke.value.reduce((e,l)=>e+((Number(l.item_price)||0)-(Number(l.purchase_cost)||0)-We(l.material_id)),0)),nl=e=>new Intl.NumberFormat("en-PK",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);async function ol(e){e.preventDefault();if(Ke.value.filter(e=>!e.vendor_id).length>0)alert("Please select a vendor for all items.");else{Re.value=!0;try{await k.post(route("courier.createOrder",{courier:"leopard"}),{destination_city:x.value,shipment_type:O[Ae.value][0][0],division:Ae.value,booked_packet_weight:Xe.value.weight,booked_packet_no_piece:Xe.value.pieces,booked_packet_collect_amount:Xe.value.cod_amount,order_id:Xe.value.order_id,consignee_name:Fe.value.name,consignee_phone:Fe.value.phone,consignee_address:Fe.value.address,advance_payment:Xe.value.advance_payment,special_instructions:Xe.value.special_instructions,platform_id:He.value,items:Ke.value.map(e=>({vendor_id:e.vendor_id,item_name:e.item_name||"",platform_id:"1",purchase_cost:e.purchase_cost||0,item_price:e.item_price||0,material_id:e.material_id||null,advance_payment:e.advance_payment||0}))});successModalButton.click()}catch(l){}finally{Re.value=!1}}}function sl(){g.visit(route("booking.index"))}return u(async()=>{try{await Promise.all([Be(),$e(),Ye(),ze()])}catch(e){}qe.value=!1,r(()=>{$(".select2").select2({placeholder:"Select Destination City",allowClear:!0}),$("#destination_city").select2().on("change",e=>{x.value=$(e.target).val()})})}),m(x,e=>{}),m(Me,e=>{}),(i,d)=>(l(),e(n,null,[d[47]||(d[47]=a("button",{"data-bs-toggle":"modal",id:"successModalButton","data-bs-target":"#successModal",style:{display:"none"}},"Testing",-1)),a("div",{class:"modal fade",id:"successModal",tabindex:"-1","aria-hidden":"true"},[a("div",{class:"modal-dialog modal-dialog-centered"},[a("div",{class:"modal-content p-4 text-center"},[a("div",{class:"modal-body"},[d[14]||(d[14]=b('<button type="button" class="btn-close position-absolute end-0 top-0 m-3" data-bs-dismiss="modal" aria-label="Close" data-v-bc6816ff></button><div class="text-success mb-3" data-v-bc6816ff><i class="bi bi-check-circle" style="font-size:3rem;" data-v-bc6816ff></i></div><h4 class="mb-2" data-v-bc6816ff>Shipment has been created</h4><p class="text-muted" data-v-bc6816ff>Your shipment was added successfully.</p>',4)),a("button",{type:"button",onClick:sl,class:"btn btn-success mt-3","data-bs-dismiss":"modal"},"Okay")])])])]),p(a("div",I,[a("form",{class:"card-body",method:"POST",onSubmit:ol},[a("div",D,[d[17]||(d[17]=a("h5",{class:"card-header"},"Create New Order",-1)),d[18]||(d[18]=a("h6",null,"Order Detail",-1)),a("div",N,[_(V,{"onUpdate:modelValue":d[0]||(d[0]=e=>Xe.value.order_id=e),label:"Order ID",type:"text",length:4,name:"order_id",placeholder:"Order ID *"}),_(P,{label:"Division *",name:"division",length:4,nonvalueitem:"Select Division","onUpdate:modelValue":d[1]||(d[1]=e=>Ae.value=e),items:[["EXPRESS","EXPRESS"],["LOGISTICS","LOGISTICS"]],selected:"EXPRESS","value-key":"0","item-key":"1"}),_(P,{label:"Shipment Type *",name:"shipment_type",length:4,nonvalueitem:"Select Shipment Type",items:O[Ae.value],selected:"OVERNIGHT","value-key":"0","item-key":"1"},null,8,["items"])]),d[19]||(d[19]=a("hr",{class:"mx-n4 my-6"},null,-1)),d[20]||(d[20]=a("h6",null,"Customer Detail",-1)),a("div",E,[_(V,{"onUpdate:modelValue":d[2]||(d[2]=e=>Fe.value.name=e),label:"Consignee Name *",type:"text",name:"consignee_name",placeholder:"Consignee Name"}),_(V,{"onUpdate:modelValue":d[3]||(d[3]=e=>Fe.value.phone=e),label:"Consignee Phone *",type:"text",name:"consignee_phone",placeholder:"Consignee Phone"}),a("div",T,[a("div",A,[p(a("select",{"onUpdate:modelValue":d[4]||(d[4]=e=>x.value=e),name:"destination_city",id:"destination_city",class:"select2 form-select select2-hidden-accessible","data-allow-clear":"true",required:""},[d[15]||(d[15]=a("option",{value:""},"Select Destination City",-1)),(l(!0),e(n,null,o(w.value,a=>(l(),e("option",{value:a.id},t(a.city),9,j))),256))],512),[[h,x.value]]),d[16]||(d[16]=a("label",{for:"destination_city"},"Destination City *",-1))])]),_(P,{"onUpdate:modelValue":d[5]||(d[5]=e=>He.value=e),label:"Platform *",name:"platform",length:6,nonvalueitem:"Select Platform",items:Le.value.map(e=>[e.id,e.name]),"value-key":"0","item-key":"1"},null,8,["items"]),_(V,{"onUpdate:modelValue":d[6]||(d[6]=e=>Fe.value.address=e),label:"Consignee Address *",type:"text",name:"consignee_address",placeholder:"Consignee Address",length:12})]),d[21]||(d[21]=a("hr",{class:"mx-n4 my-6"},null,-1)),d[22]||(d[22]=a("h6",null,"Shipment Detail",-1)),a("div",M,[_(V,{"onUpdate:modelValue":d[7]||(d[7]=e=>Xe.value.weight=e),label:"Weigh (grams) *",type:"text",length:4,name:"weight",placeholder:"Weight (grams) *"}),_(V,{"onUpdate:modelValue":d[8]||(d[8]=e=>Xe.value.pieces=e),label:"No. of Pieces *",type:"text",name:"pieces",length:4,placeholder:"No. of Pieces *"}),_(V,{"onUpdate:modelValue":d[9]||(d[9]=e=>Xe.value.product_description=e),label:"Product Description *",type:"text",name:"product_description",length:4,placeholder:"Product Description *"}),_(V,{"onUpdate:modelValue":d[10]||(d[10]=e=>Xe.value.cod_amount=e),label:"COD Amount *",type:"number",name:"cod_amount",placeholder:"COD Amount *"}),_(V,{"onUpdate:modelValue":d[11]||(d[11]=e=>Xe.value.advance_payment=e),label:"Advance Payment *",type:"number",name:"advance_payment",placeholder:"Advance Payment *"}),_(V,{"onUpdate:modelValue":d[12]||(d[12]=e=>Xe.value.special_instructions=e),label:"Special Instructions *",type:"text",name:"special_instructions",length:12,placeholder:"Handle with care *","is-text-area":""})])]),je.value?(l(),e("div",R,[d[33]||(d[33]=a("h6",null,"3. Items Details",-1)),a("div",G,[a("table",L,[a("thead",{class:"table-light"},[a("tr",null,[d[23]||(d[23]=a("th",null,"Vendor",-1)),d[24]||(d[24]=a("th",null,"Product Name",-1)),d[25]||(d[25]=a("th",null,"Cost",-1)),d[26]||(d[26]=a("th",null,"Selling",-1)),d[27]||(d[27]=a("th",null,"Packaging Material",-1)),d[28]||(d[28]=a("th",null,"Total Amount",-1)),d[29]||(d[29]=a("th",null,"Profit",-1)),a("th",{style:{width:"64px"}},[a("button",{type:"button",style:{color:"white"},class:"btn btn-sm btn-success",onClick:Je},"+")])])]),a("tbody",null,[(l(!0),e(n,null,o(Ke.value,s=>(l(),e("tr",{key:s.id},[a("td",null,[p(a("select",{"onUpdate:modelValue":e=>s.vendor_id=e,class:"form-select",required:""},[d[30]||(d[30]=a("option",{value:""},"Select Vendor",-1)),(l(!0),e(n,null,o(Ge.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,K))),128))],8,q),[[h,s.vendor_id]])]),a("td",null,[p(a("input",{type:"text","onUpdate:modelValue":e=>s.item_name=e,class:"form-control",placeholder:"Product Name (Optional)"},null,8,F),[[S,s.item_name]])]),a("td",null,[p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>s.purchase_cost=e,class:"form-control",placeholder:"Cost (Optional)"},null,8,H),[[S,s.purchase_cost,void 0,{number:!0}]])]),a("td",null,[p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>s.item_price=e,class:"form-control",placeholder:"Selling Price (Optional)"},null,8,X),[[S,s.item_price,void 0,{number:!0}]])]),a("td",null,[p(a("select",{"onUpdate:modelValue":e=>s.material_id=e,class:"form-select"},[d[31]||(d[31]=a("option",{value:""},"Select Material (Optional)",-1)),(l(!0),e(n,null,o(U.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,Y))),128))],8,B),[[h,s.material_id]])]),a("td",null,[a("input",{type:"number",value:s.item_price||0,class:"form-control",readonly:""},null,8,z)]),a("td",null,[a("input",{type:"number",value:parseInt((s.item_price||0)-(s.purchase_cost||0))-We(s.material_id),class:"form-control",readonly:""},null,8,W)]),a("td",null,[a("button",{type:"button",class:"btn btn-sm btn-danger",onClick:e=>Qe(s.id)},"-",8,J)])]))),128)),a("tr",Q,[d[32]||(d[32]=a("td",{class:"totals-label"},[a("strong",null,"Total")],-1)),a("td",Z,[a("strong",null,t(Ke.value.length)+" Items",1)]),a("td",ee,[a("strong",null,t(nl(Ze.value)),1)]),a("td",le,[a("strong",null,t(nl(el.value)),1)]),a("td",ae,[a("strong",null,t(nl(ll.value)),1)]),a("td",te,[a("strong",null,t(nl(al.value)),1)]),a("td",ne,[a("strong",{class:s({"text-danger":tl.value<0,"text-success":tl.value>0})},t(nl(tl.value)),3)]),a("td",oe,[a("strong",null,t(el.value>0?(tl.value/el.value*100).toFixed(1):0)+"%",1)])])])])])])):v("",!0),je.value?(l(),e("div",se,[a("div",{class:"d-flex align-items-center justify-content-between mb-2"},[d[34]||(d[34]=a("h6",{class:"mb-0"},"Items",-1)),a("button",{type:"button",class:"btn btn-sm btn-success",onClick:Je},"Add")]),(l(!0),e(n,null,o(Ke.value,s=>(l(),e("div",{key:"m-"+s.id,class:"item-card mb-3"},[a("div",ie,[a("strong",null,"#"+t(s.id),1),a("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>Qe(s.id)},"Remove",8,de)]),a("div",ce,[a("div",ue,[d[36]||(d[36]=a("label",{class:"form-label"},"Vendor",-1)),p(a("select",{"onUpdate:modelValue":e=>s.vendor_id=e,class:"form-select",required:""},[d[35]||(d[35]=a("option",{value:""},"Select Vendor",-1)),(l(!0),e(n,null,o(Ge.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,me))),128))],8,re),[[h,s.vendor_id]])]),a("div",pe,[d[37]||(d[37]=a("label",{class:"form-label"},"Product Name",-1)),p(a("input",{type:"text","onUpdate:modelValue":e=>s.item_name=e,class:"form-control",placeholder:"e.g. T-Shirt (Optional)"},null,8,ve),[[S,s.item_name]])]),a("div",be,[d[38]||(d[38]=a("label",{class:"form-label"},"Cost",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>s.purchase_cost=e,class:"form-control",placeholder:"Cost (Optional)"},null,8,ye),[[S,s.purchase_cost,void 0,{number:!0}]])]),a("div",_e,[d[39]||(d[39]=a("label",{class:"form-label"},"Selling",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>s.item_price=e,class:"form-control",placeholder:"Selling Price (Optional)"},null,8,he),[[S,s.item_price,void 0,{number:!0}]])]),a("div",fe,[d[41]||(d[41]=a("label",{class:"form-label"},"Packaging Material",-1)),p(a("select",{"onUpdate:modelValue":e=>s.material_id=e,class:"form-select"},[d[40]||(d[40]=a("option",{value:""},"Select Material (Optional)",-1)),(l(!0),e(n,null,o(U.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,Se))),128))],8,ge),[[h,s.material_id]])]),a("div",Ve,[d[42]||(d[42]=a("label",{class:"form-label"},"Total",-1)),a("input",{type:"number",value:s.item_price||0,class:"form-control",readonly:""},null,8,ke)]),a("div",Ce,[d[43]||(d[43]=a("label",{class:"form-label"},"Profit",-1)),a("input",{type:"number",value:parseInt((s.item_price||0)-(s.purchase_cost||0))-We(s.material_id),class:"form-control",readonly:""},null,8,we)]),a("div",xe,[d[44]||(d[44]=a("label",{class:"form-label"},"Advance Payment",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>s.advance_payment=e,class:"form-control",placeholder:"Advance Payment (Optional)"},null,8,Oe),[[S,s.advance_payment,void 0,{number:!0}]])])])]))),128))])):v("",!0),a("div",Ue,[a("button",{disabled:Re.value,type:"submit",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px"}},[Re.value?(l(),e("span",Ie)):(l(),e("span",De,"Book Order"))],8,Pe),a("a",{onClick:d[13]||(d[13]=e=>je.value=!je.value),type:"cancel",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px",color:"white",gap:"10px","align-items":"center"}},[f(t(je.value?"Hide":"Show")+" Chart ",1),je.value?(l(),e("i",Ee)):(l(),e("i",Ne))]),d[45]||(d[45]=a("button",{type:"reset",class:"btn btn-outline-secondary waves-effect me-4"},"Cancel",-1))])],32)],512),[[y,!qe.value]]),qe.value?(l(),e("div",Te,d[46]||(d[46]=[a("span",{class:"spinner"},null,-1)]))):v("",!0)],64))}}),[["__scopeId","data-v-bc6816ff"]]);export{Ae as default};
