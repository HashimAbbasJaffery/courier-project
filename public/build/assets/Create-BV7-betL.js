import{c as e,a as l,d as a,t,F as n,m as s,p as o,g as i,r as d,D as c,o as u,n as r,z as m,A as p,k as v,b,E as y,e as _,C as h,G as g,B as f}from"./vendor-DCAUJ3rR.js";import{_ as S}from"./Input-CreZEH89.js";import{a as V}from"./data-C-1G2k3o.js";import{_ as k}from"./app-eGF7VWS9.js";import"./ui-qR5y7ijB.js";const C={class:"form-floating form-floating-outline"},x=["name"],U={value:""},w=["selected","value"],O={__name:"DropdownMenu",props:{label:String,name:String,length:{default:6,type:Number,required:!0},nonvalueitem:String,items:Array,valueKey:String,itemKey:String,selected:String},emits:["update:modelValue"],setup(i,{emit:d}){const c=d;return(d,u)=>(l(),e("div",{class:o(`col-md-${i.length}`)},[a("div",C,[a("select",{onChange:u[0]||(u[0]=e=>c("update:modelValue",e.target.value)),name:i.name,class:"form-select",required:""},[a("option",U,t(i.nonvalueitem),1),(l(!0),e(n,null,s(i.items,a=>(l(),e("option",{selected:a[i.valueKey]==i.selected,key:a.id,value:a[i.valueKey]},t(a[i.itemKey]),9,w))),128))],40,x),a("label",null,t(i.label),1)])],2))}},P={class:"container-xxl container-p-y flex-grow-1"},I={class:"card mb-4 p-3"},D={class:"row g-6"},E={class:"row g-6"},T={class:"col-md-6"},N={class:"form-floating form-floating-outline form-floating-select2"},A=["value"],M={class:"row g-6"},R={key:0,class:"card mb-4 p-3 d-none d-md-block"},j={class:"table-responsive"},G={class:"table table-bordered align-middle",id:"itemsTable"},q=["onUpdate:modelValue"],L=["value"],K=["onUpdate:modelValue"],F=["onUpdate:modelValue"],H=["onUpdate:modelValue"],X=["onUpdate:modelValue"],B=["value"],Y=["value"],z=["value"],W=["onClick"],J={class:"table-totals"},Q={class:"totals-label"},Z={class:"totals-value"},ee={class:"totals-value"},le={class:"totals-value"},ae={class:"totals-value"},te={class:"totals-value"},ne={class:"totals-label"},se={key:1,class:"card mb-4 p-3 d-block d-md-none"},oe={class:"item-card__header"},ie=["onClick"],de={class:"row g-2"},ce={class:"col-12"},ue=["onUpdate:modelValue"],re=["value"],me={class:"col-12"},pe=["onUpdate:modelValue"],ve={class:"col-6"},be=["onUpdate:modelValue"],ye={class:"col-6"},_e=["onUpdate:modelValue"],he={class:"col-12"},ge=["onUpdate:modelValue"],fe=["value"],Se={class:"col-6"},Ve=["value"],ke={class:"col-6"},Ce=["value"],xe={class:"col-12"},Ue=["onUpdate:modelValue"],we={class:"pt-6",style:{display:"flex","justify-content":"flex-start"}},Oe=["disabled"],Pe={key:0,class:"loader small"},Ie={key:1},De={key:0,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",height:"100vh"}},Ee=k(i({__name:"Create",setup(i){const k=d([]),C=d([]),x={EXPRESS:[["OVERNIGHT","OVERNIGHT"],["ECONOMY","ECONOMY"]],LOGISTICS:[["OVERLAND LOGISTICS","OVERLAND LOGISTICS"]]},U=d([]),w=d("EXPRESS"),Ee=d(!1),Te=d([]),Ne=d(!1),Ae=d([]),Me=d([]),Re=d(!0),je=d([{id:1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0}]),Ge=d({name:"",phone:"",address:""}),qe=d(null),Le=d(null),Ke=d({division:"",shipment_type:"",product_description:"",weight:"",pieces:"",advance_payment:0,payment_type:"COD",cod_amount:"",order_id:"",special_instructions:""});async function Fe(){const e=await V.get(route("courier.cities",{courier:"leopard"}));k.value=e.data.data}async function He(){const e=await V.get(route("platforms.get"));Me.value=e.data.data}async function Xe(){const e=await V.get(route("materials.get"));U.value=e.data.data}async function Be(){const e=await V.get(route("vendors.get"));Ae.value=e.data.data}const $e=e=>{const l=U.value.find(l=>l.id===e);return l?l.price:0},Ye=()=>{const e={id:je.value.length+1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0};je.value.push(e)},ze=e=>{je.value=je.value.filter(l=>l.id!==e),je.value.forEach((e,l)=>{e.id=l+1}),0===je.value.length&&Ye()},We=c(()=>je.value.reduce((e,l)=>e+(l.purchase_cost||0),0)),Je=c(()=>je.value.reduce((e,l)=>e+(l.item_price||0),0)),Qe=c(()=>je.value.reduce((e,l)=>e+$e(l.material_id),0)),Ze=c(()=>je.value.reduce((e,l)=>e+(l.item_price||0),0)),el=c(()=>je.value.reduce((e,l)=>e+((l.item_price||0)-(l.purchase_cost||0)-$e(l.material_id)),0)),ll=e=>new Intl.NumberFormat("en-PK",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);async function al(e){e.preventDefault(),Ne.value=!0;try{await V.post(route("courier.createOrder",{courier:"leopard"}),{destination_city:C.value,shipment_type:x[w.value][0][0],division:w.value,booked_packet_weight:Ke.value.weight,booked_packet_no_piece:Ke.value.pieces,booked_packet_collect_amount:Ke.value.cod_amount,order_id:Ke.value.order_id,consignee_name:Ge.value.name,consignee_phone:Ge.value.phone,consignee_address:Ge.value.address,advance_payment:Ke.value.advance_payment,special_instructions:Ke.value.special_instructions,vendor_id:qe.value,platform_id:Le.value,items:je.value.map(e=>({item_name:e.item_name,platform_id:"1",purchase_cost:e.purchase_cost,item_price:e.item_price,material_id:e.material_id,advance_payment:"1"}))});successModalButton.click()}catch(l){}finally{Ne.value=!1}}function tl(){g.visit(route("booking.index"))}return u(async()=>{try{await Promise.all([Fe(),He(),Xe(),Be()])}catch(e){}Re.value=!1,r(()=>{$(".select2").select2({placeholder:"Select Destination City",allowClear:!0}),$("#destination_city").select2().on("change",e=>{C.value=$(e.target).val()})})}),m(C,e=>{}),m(Te,e=>{}),(i,d)=>(l(),e(n,null,[d[47]||(d[47]=a("button",{"data-bs-toggle":"modal",id:"successModalButton","data-bs-target":"#successModal",style:{display:"none"}},"Testing",-1)),a("div",{class:"modal fade",id:"successModal",tabindex:"-1","aria-hidden":"true"},[a("div",{class:"modal-dialog modal-dialog-centered"},[a("div",{class:"modal-content p-4 text-center"},[a("div",{class:"modal-body"},[d[14]||(d[14]=b('<button type="button" class="btn-close position-absolute end-0 top-0 m-3" data-bs-dismiss="modal" aria-label="Close" data-v-1b8736fe></button><div class="text-success mb-3" data-v-1b8736fe><i class="bi bi-check-circle" style="font-size:3rem;" data-v-1b8736fe></i></div><h4 class="mb-2" data-v-1b8736fe>Shipment has been created</h4><p class="text-muted" data-v-1b8736fe>Your shipment was added successfully.</p>',4)),a("button",{type:"button",onClick:tl,class:"btn btn-success mt-3","data-bs-dismiss":"modal"},"Okay")])])])]),p(a("div",P,[a("form",{class:"card-body",method:"POST",onSubmit:al},[a("div",I,[d[17]||(d[17]=a("h5",{class:"card-header"},"Create New Order",-1)),d[18]||(d[18]=a("h6",null,"Order Detail",-1)),a("div",D,[_(S,{"onUpdate:modelValue":d[0]||(d[0]=e=>Ke.value.order_id=e),label:"Order ID",type:"text",length:4,name:"order_id",placeholder:"Order ID *"}),_(O,{label:"Division *",name:"division",length:4,nonvalueitem:"Select Division","onUpdate:modelValue":d[1]||(d[1]=e=>w.value=e),items:[["EXPRESS","EXPRESS"],["LOGISTICS","LOGISTICS"]],selected:"EXPRESS","value-key":"0","item-key":"1"}),_(O,{label:"Shipment Type *",name:"shipment_type",length:4,nonvalueitem:"Select Shipment Type",items:x[w.value],selected:"OVERNIGHT","value-key":"0","item-key":"1"},null,8,["items"])]),d[19]||(d[19]=a("hr",{class:"mx-n4 my-6"},null,-1)),d[20]||(d[20]=a("h6",null,"Customer Detail",-1)),a("div",E,[_(S,{"onUpdate:modelValue":d[2]||(d[2]=e=>Ge.value.name=e),label:"Consignee Name *",type:"text",name:"consignee_name",placeholder:"Consignee Name"}),_(S,{"onUpdate:modelValue":d[3]||(d[3]=e=>Ge.value.phone=e),label:"Consignee Phone *",type:"text",name:"consignee_phone",placeholder:"Consignee Phone"}),a("div",T,[a("div",N,[p(a("select",{"onUpdate:modelValue":d[4]||(d[4]=e=>C.value=e),name:"destination_city",id:"destination_city",class:"select2 form-select select2-hidden-accessible","data-allow-clear":"true",required:""},[d[15]||(d[15]=a("option",{value:""},"Select Destination City",-1)),(l(!0),e(n,null,s(k.value,a=>(l(),e("option",{value:a.id},t(a.city),9,A))),256))],512),[[h,C.value]]),d[16]||(d[16]=a("label",{for:"destination_city"},"Destination City *",-1))])]),_(O,{"onUpdate:modelValue":d[5]||(d[5]=e=>Le.value=e),label:"Platform *",name:"platform",length:6,nonvalueitem:"Select Platform",items:Me.value.map(e=>[e.id,e.name]),"value-key":"0","item-key":"1"},null,8,["items"]),_(S,{"onUpdate:modelValue":d[6]||(d[6]=e=>Ge.value.address=e),label:"Consignee Address *",type:"text",name:"consignee_address",placeholder:"Consignee Address",length:12})]),d[21]||(d[21]=a("hr",{class:"mx-n4 my-6"},null,-1)),d[22]||(d[22]=a("h6",null,"Shipment Detail",-1)),a("div",M,[_(S,{"onUpdate:modelValue":d[7]||(d[7]=e=>Ke.value.weight=e),label:"Weigh (grams) *",type:"text",length:4,name:"weight",placeholder:"Weight (grams) *"}),_(S,{"onUpdate:modelValue":d[8]||(d[8]=e=>Ke.value.pieces=e),label:"No. of Pieces *",type:"text",name:"pieces",length:4,placeholder:"No. of Pieces *"}),_(S,{"onUpdate:modelValue":d[9]||(d[9]=e=>Ke.value.product_description=e),label:"Product Description *",type:"text",name:"product_description",length:4,placeholder:"Product Description *"}),_(S,{"onUpdate:modelValue":d[10]||(d[10]=e=>Ke.value.cod_amount=e),label:"COD Amount *",type:"number",name:"cod_amount",placeholder:"COD Amount *"}),_(S,{"onUpdate:modelValue":d[11]||(d[11]=e=>Ke.value.advance_payment=e),label:"Advance Payment *",type:"number",name:"advance_payment",placeholder:"Advance Payment *"}),_(S,{"onUpdate:modelValue":d[12]||(d[12]=e=>Ke.value.special_instructions=e),label:"Special Instructions *",type:"text",name:"special_instructions",length:12,placeholder:"Handle with care *","is-text-area":""})])]),Ee.value?(l(),e("div",R,[d[33]||(d[33]=a("h6",null,"3. Items Details",-1)),a("div",j,[a("table",G,[a("thead",{class:"table-light"},[a("tr",null,[d[23]||(d[23]=a("th",null,"Vendor",-1)),d[24]||(d[24]=a("th",null,"Product Name",-1)),d[25]||(d[25]=a("th",null,"Cost",-1)),d[26]||(d[26]=a("th",null,"Selling",-1)),d[27]||(d[27]=a("th",null,"Packaging Material",-1)),d[28]||(d[28]=a("th",null,"Total Amount",-1)),d[29]||(d[29]=a("th",null,"Profit",-1)),a("th",{style:{width:"64px"}},[a("button",{type:"button",class:"btn btn-sm btn-success",onClick:Ye},"+")])])]),a("tbody",null,[(l(!0),e(n,null,s(je.value,o=>(l(),e("tr",{key:o.id},[a("td",null,[p(a("select",{"onUpdate:modelValue":e=>o.vendor_id=e,class:"form-select",required:""},[d[30]||(d[30]=a("option",{value:""},"Select Vendor",-1)),(l(!0),e(n,null,s(Ae.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,L))),128))],8,q),[[h,o.vendor_id]])]),a("td",null,[p(a("input",{type:"text","onUpdate:modelValue":e=>o.item_name=e,class:"form-control"},null,8,K),[[f,o.item_name]])]),a("td",null,[p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.purchase_cost=e,class:"form-control"},null,8,F),[[f,o.purchase_cost,void 0,{number:!0}]])]),a("td",null,[p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.item_price=e,class:"form-control"},null,8,H),[[f,o.item_price,void 0,{number:!0}]])]),a("td",null,[p(a("select",{"onUpdate:modelValue":e=>o.material_id=e,class:"form-select"},[d[31]||(d[31]=a("option",{value:""},"Select Material",-1)),(l(!0),e(n,null,s(U.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,B))),128))],8,X),[[h,o.material_id]])]),a("td",null,[a("input",{type:"number",value:o.item_price,class:"form-control",readonly:""},null,8,Y)]),a("td",null,[a("input",{type:"number",value:parseInt(o.item_price-o.purchase_cost)-$e(o.material_id),class:"form-control",readonly:""},null,8,z)]),a("td",null,[a("button",{type:"button",class:"btn btn-sm btn-danger",onClick:e=>ze(o.id)},"-",8,W)])]))),128)),a("tr",J,[d[32]||(d[32]=a("td",{class:"totals-label"},[a("strong",null,"Total")],-1)),a("td",Q,[a("strong",null,t(je.value.length)+" Items",1)]),a("td",Z,[a("strong",null,t(ll(We.value)),1)]),a("td",ee,[a("strong",null,t(ll(Je.value)),1)]),a("td",le,[a("strong",null,t(ll(Qe.value)),1)]),a("td",ae,[a("strong",null,t(ll(Ze.value)),1)]),a("td",te,[a("strong",{class:o({"text-danger":el.value<0,"text-success":el.value>0})},t(ll(el.value)),3)]),a("td",ne,[a("strong",null,t(Je.value>0?(el.value/Je.value*100).toFixed(1):0)+"%",1)])])])])])])):v("",!0),Ee.value?(l(),e("div",se,[a("div",{class:"d-flex align-items-center justify-content-between mb-2"},[d[34]||(d[34]=a("h6",{class:"mb-0"},"Items",-1)),a("button",{type:"button",class:"btn btn-sm btn-success",onClick:Ye},"Add")]),(l(!0),e(n,null,s(je.value,o=>(l(),e("div",{key:"m-"+o.id,class:"item-card mb-3"},[a("div",oe,[a("strong",null,"#"+t(o.id),1),a("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>ze(o.id)},"Remove",8,ie)]),a("div",de,[a("div",ce,[d[36]||(d[36]=a("label",{class:"form-label"},"Vendor",-1)),p(a("select",{"onUpdate:modelValue":e=>o.vendor_id=e,class:"form-select",required:""},[d[35]||(d[35]=a("option",{value:""},"Select Vendor",-1)),(l(!0),e(n,null,s(Ae.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,re))),128))],8,ue),[[h,o.vendor_id]])]),a("div",me,[d[37]||(d[37]=a("label",{class:"form-label"},"Product Name",-1)),p(a("input",{type:"text","onUpdate:modelValue":e=>o.item_name=e,class:"form-control",placeholder:"e.g. T-Shirt",required:""},null,8,pe),[[f,o.item_name]])]),a("div",ve,[d[38]||(d[38]=a("label",{class:"form-label"},"Cost",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.purchase_cost=e,class:"form-control"},null,8,be),[[f,o.purchase_cost,void 0,{number:!0}]])]),a("div",ye,[d[39]||(d[39]=a("label",{class:"form-label"},"Selling",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.item_price=e,class:"form-control"},null,8,_e),[[f,o.item_price,void 0,{number:!0}]])]),a("div",he,[d[41]||(d[41]=a("label",{class:"form-label"},"Packaging Material",-1)),p(a("select",{"onUpdate:modelValue":e=>o.material_id=e,class:"form-select"},[d[40]||(d[40]=a("option",{value:""},"Select Material",-1)),(l(!0),e(n,null,s(U.value,a=>(l(),e("option",{key:a.id,value:a.id},t(a.name),9,fe))),128))],8,ge),[[h,o.material_id]])]),a("div",Se,[d[42]||(d[42]=a("label",{class:"form-label"},"Total",-1)),a("input",{type:"number",value:o.item_price,class:"form-control",readonly:""},null,8,Ve)]),a("div",ke,[d[43]||(d[43]=a("label",{class:"form-label"},"Profit",-1)),a("input",{type:"number",value:parseInt(o.item_price-o.purchase_cost)-$e(o.material_id),class:"form-control",readonly:""},null,8,Ce)]),a("div",xe,[d[44]||(d[44]=a("label",{class:"form-label"},"Advance Payment",-1)),p(a("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.advance_payment=e,class:"form-control"},null,8,Ue),[[f,o.advance_payment,void 0,{number:!0}]])])])]))),128))])):v("",!0),a("div",we,[a("button",{disabled:Ne.value,type:"submit",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px"}},[Ne.value?(l(),e("span",Pe)):(l(),e("span",Ie,"Book Order"))],8,Oe),a("a",{onClick:d[13]||(d[13]=e=>Ee.value=!Ee.value),type:"cancel",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px",color:"white"}},t(Ee.value?"Hide":"Show")+" Chart ",1),d[45]||(d[45]=a("button",{type:"reset",class:"btn btn-outline-secondary waves-effect me-4"},"Cancel",-1))])],32)],512),[[y,!Re.value]]),Re.value?(l(),e("div",De,d[46]||(d[46]=[a("span",{class:"spinner"},null,-1)]))):v("",!0)],64))}}),[["__scopeId","data-v-1b8736fe"]]);export{Ee as default};
