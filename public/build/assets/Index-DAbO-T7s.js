import{g as e,r as t,y as a,o as n,n as o,z as i,c as l,a as d,d as s,A as c,B as r,C as u,b as p,F as v,m as g,k as m,t as _}from"./vendor-DCAUJ3rR.js";import{a as y}from"./data-C-1G2k3o.js";import{_ as h}from"./app-BLeKxEwx.js";import"./ui-qR5y7ijB.js";const k={key:0,class:"container-xxl container-p-y flex-grow-1"},b={class:"card mb-4 p-3"},f={id:"filterForm"},x={class:"row"},D={class:"col-md-6"},C={class:"col-md-6"},R={class:"row mt-2"},S={class:"col-md-6"},w={id:"origin_city",class:"form-control select2"},A=["value"],Y={class:"col-md-6"},P={id:"destination_city",class:"form-control select2"},M=["value"],j={class:"card position-relative"},B={key:0,class:"loading-overlay"},O={class:"table-responsive text-nowrap"},T={id:"adviceTable",class:"table-bordered table align-middle"},F={class:"text-truncate",style:{"max-width":"180px"}},q={class:"fw-semibold"},N={class:"text-muted",style:{"font-size":"12px"}},I={class:"text-truncate",style:{"max-width":"260px"}},V={key:1,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",height:"60vh"}},z="#adviceTable",E=h(e({__name:"Index",setup(e){const h=t([]),E=t([]),H=t(!0),K=t(!1),U=a({dateRange:"",status:"",originCity:"",destination_city:""});function J(e){if(!e)return"N/A";const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`}const L=async()=>{try{const e=await y.get(route("courier.cities",{courier:"leopard"}));E.value=e.data?.data??[]}catch(e){}},W=async()=>{try{K.value=!0;const[e,t]=(U.dateRange||"").split(" - "),a=await y.get("/api/shipper-advices",{params:{from:e||"",to:t||"",origin_city:U.originCity||"",destination_city:U.destination_city||"",status:U.status||""}});h.value=(a.data?.data??[]).map(e=>({track_number:e.track_number,booked_packet_date:e.booked_packet_date,consignment_name_eng:e.consignment_name_eng||e.consignee_name||e.consignee||"—",consignment_phone:e.consignment_phone||e.consignee_phone||"—",origin_city_name:e.origin_city_name||"—",destination_city_name:e.destination_city_name||"—",booked_packet_collect_amount:e.booked_packet_collect_amount,booked_packet_status:e.booked_packet_status||"—",pending_reason:e.pending_reason||"",advice_text:e.advice_text||"—",advice_date_created:e.advice_date_created})),$.fn.DataTable.isDataTable(z)&&$(z).DataTable().destroy(),o(()=>{$(z).DataTable({info:!1,searching:!1,lengthChange:!1,scrollX:!0,autoWidth:!1,pageLength:10,columnDefs:[{targets:-1,orderable:!1}]})})}catch(e){}finally{K.value=!1}};return n(async()=>{await Promise.all([L(),W()]),o(()=>{$("#origin_city").select2().on("change",e=>{U.originCity=$(e.target).val()}),$("#destination_city").select2().on("change",e=>{U.destination_city=$(e.target).val()}),$("#status").select2().on("change",e=>{U.status=$(e.target).val()}),$("#daterange").daterangepicker({locale:{format:"YYYY-MM-DD"}},function(e,t){U.dateRange=`${e.format("YYYY-MM-DD")} - ${t.format("YYYY-MM-DD")}`})}),H.value=!1}),i(U,async()=>{await W()}),(e,t)=>H.value?(d(),l("div",V,t[12]||(t[12]=[s("span",{class:"loader"},null,-1)]))):(d(),l("div",k,[s("div",b,[s("form",f,[s("div",x,[s("div",D,[t[2]||(t[2]=s("label",null,[s("strong",null,"Date Range:")],-1)),c(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>U.dateRange=e),name:"daterange",id:"daterange",class:"form-control"},null,512),[[r,U.dateRange]])]),s("div",C,[t[4]||(t[4]=s("label",null,[s("strong",null,"Status:")],-1)),c(s("select",{name:"status","onUpdate:modelValue":t[1]||(t[1]=e=>U.status=e),id:"status",class:"form-control select2"},t[3]||(t[3]=[p('<option value="" data-v-e6d6a30d>All Status</option><option value="Drop Off at Express Center" data-v-e6d6a30d>Drop Off at Express Center</option><option value="Shipment Picked" data-v-e6d6a30d>Shipment Picked</option><option value="Being Return" data-v-e6d6a30d>Being Return</option><option value="Ready for Return" data-v-e6d6a30d>Ready for Return</option><option value="Dispatched" data-v-e6d6a30d>Dispatched</option><option value="Delivered" data-v-e6d6a30d>Delivered</option><option value="Pending" data-v-e6d6a30d>Pending</option><option value="Missroute" data-v-e6d6a30d>Missroute</option><option value="Returned to shipper" data-v-e6d6a30d>Returned to shipper</option><option value="Arrived at Station" data-v-e6d6a30d>Arrived at Station</option><option value="Assign to Courier" data-v-e6d6a30d>Assign to Courier</option><option value="Consignment Booked" data-v-e6d6a30d>Consignment Booked</option><option value="Cancelled" data-v-e6d6a30d>Cancelled</option><option value="Pickup Request Sent" data-v-e6d6a30d>Pickup Request Sent</option><option value="48 Hours Auto Canceled" data-v-e6d6a30d>48 Hours Auto Canceled</option><option value="Pickup Request not Send" data-v-e6d6a30d>Pickup Request not Send</option>',17)]),512),[[u,U.status]])])]),s("div",R,[s("div",S,[t[6]||(t[6]=s("label",null,[s("strong",null,"Origin City:")],-1)),s("select",w,[t[5]||(t[5]=s("option",{value:""},"All Origins",-1)),(d(!0),l(v,null,g(E.value,e=>(d(),l("option",{key:e.id+"-o",value:e.city},_(e.city),9,A))),128))])]),s("div",Y,[t[8]||(t[8]=s("label",null,[s("strong",null,"Destination City:")],-1)),s("select",P,[t[7]||(t[7]=s("option",{value:""},"All Destinations",-1)),(d(!0),l(v,null,g(E.value,e=>(d(),l("option",{key:e.id+"-d",value:e.id},_(e.city),9,M))),128))])])])])]),s("div",j,[t[11]||(t[11]=s("div",{class:"d-flex justify-content-between align-items-center px-3 pt-3"},[s("h5",{class:"card-header border-0 p-0"},"Shipper Advices")],-1)),K.value?(d(),l("div",B,t[9]||(t[9]=[s("div",{class:"loading-spinner"},null,-1),s("div",{class:"mt-3 text-muted"},"Fetching data...",-1)]))):m("",!0),s("div",O,[s("table",T,[t[10]||(t[10]=s("thead",null,[s("tr",null,[s("th",null,"CN"),s("th",null,"Booked On"),s("th",null,"Consignee"),s("th",null,"Journey"),s("th",null,"COD Value"),s("th",null,"Status"),s("th",null,"Pending Reason"),s("th",null,"Advice"),s("th",null,"Advice Date")])],-1)),s("tbody",null,[(d(!0),l(v,null,g(h.value,e=>{return d(),l("tr",{key:e.track_number},[s("td",null,[s("strong",null,_(e.track_number),1)]),s("td",null,_(J(e.booked_packet_date)),1),s("td",F,[s("div",q,_(e.consignment_name_eng),1),s("div",N,_(e.consignment_phone),1)]),s("td",null,_(e.origin_city_name)+" -> "+_(e.destination_city_name),1),s("td",null,_((t=e.booked_packet_collect_amount,t??0===t?new Intl.NumberFormat("en-PK").format(Number(t)):"—"))+" PKR",1),s("td",null,_(e.booked_packet_status),1),s("td",null,_(e.pending_reason),1),s("td",I,_(e.advice_text),1),s("td",null,_(J(e.advice_date_created)),1)]);var t}),128))])])])])]))}}),[["__scopeId","data-v-e6d6a30d"]]);export{E as default};
