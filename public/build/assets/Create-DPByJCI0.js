import{c as e,a,d as l,t,F as n,m as s,p as o,g as i,r as d,D as c,o as u,n as r,z as m,A as p,k as v,b,E as y,e as _,C as h,G as g,B as f}from"./vendor-DCAUJ3rR.js";import{_ as V}from"./Input-CreZEH89.js";import{a as k}from"./data-C-1G2k3o.js";import{_ as S}from"./app-D3meR34w.js";import"./ui-qR5y7ijB.js";const C={class:"form-floating form-floating-outline"},x=["name"],U={value:""},w=["value"],O={__name:"DropdownMenu",props:{label:String,name:String,length:{default:6,type:Number,required:!0},nonvalueitem:String,items:Array,valueKey:String,itemKey:String},emits:["update:modelValue"],setup(i,{emit:d}){const c=d;return(d,u)=>(a(),e("div",{class:o(`col-md-${i.length}`)},[l("div",C,[l("select",{onChange:u[0]||(u[0]=e=>c("update:modelValue",e.target.value)),name:i.name,class:"form-select",required:""},[l("option",U,t(i.nonvalueitem),1),(a(!0),e(n,null,s(i.items,l=>(a(),e("option",{key:l.id,value:l[i.valueKey]},t(l[i.itemKey]),9,w))),128))],40,x),l("label",null,t(i.label),1)])],2))}},D={class:"container-xxl container-p-y flex-grow-1"},I={class:"card mb-4 p-3"},P={class:"row g-6"},T={class:"row g-6"},N={class:"col-md-6"},E={class:"form-floating form-floating-outline form-floating-select2"},A=["value"],M={class:"row g-6"},j={key:0,class:"card mb-4 p-3 d-none d-md-block"},q={class:"table-responsive"},G={class:"table table-bordered align-middle",id:"itemsTable"},R=["onUpdate:modelValue"],L=["value"],F=["onUpdate:modelValue"],K=["onUpdate:modelValue"],B=["onUpdate:modelValue"],H=["onUpdate:modelValue"],X=["value"],Y=["value"],z=["value"],W=["onClick"],J={class:"table-totals"},Q={class:"totals-label"},Z={class:"totals-value"},ee={class:"totals-value"},ae={class:"totals-value"},le={class:"totals-value"},te={class:"totals-value"},ne={class:"totals-label"},se={key:1,class:"card mb-4 p-3 d-block d-md-none"},oe={class:"item-card__header"},ie=["onClick"],de={class:"row g-2"},ce={class:"col-12"},ue=["onUpdate:modelValue"],re=["value"],me={class:"col-12"},pe=["onUpdate:modelValue"],ve={class:"col-6"},be=["onUpdate:modelValue"],ye={class:"col-6"},_e=["onUpdate:modelValue"],he={class:"col-12"},ge=["onUpdate:modelValue"],fe=["value"],Ve={class:"col-6"},ke=["value"],Se={class:"col-6"},Ce=["value"],xe={class:"col-12"},Ue=["onUpdate:modelValue"],we={class:"pt-6",style:{display:"flex","justify-content":"flex-start"}},Oe=["disabled"],De={key:0,class:"loader small"},Ie={key:1},Pe={key:0,style:{display:"flex","align-items":"center","justify-content":"center","flex-direction":"column",height:"100vh"}},Te=S(i({__name:"Create",setup(i){const S=d([]),C=d([]),x={EXPRESS:[["OVERNIGHT","OVERNIGHT"],["ECONOMY","ECONOMY"]],LOGISTICS:[["OVERLAND LOGISTICS","OVERLAND LOGISTICS"]]},U=d([]),w=d(""),Te=d(!1),Ne=d([]),Ee=d(!1),Ae=d([]),Me=d([]),je=d(!0),qe=d([{id:1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0}]),Ge=d({name:"",phone:"",address:""}),Re=d(null),Le=d(null),Fe=d({division:"",shipment_type:"",product_description:"",weight:"",pieces:"",advance_payment:0,payment_type:"COD",cod_amount:"",order_id:"",special_instructions:""});async function Ke(){const e=await k.get(route("courier.cities",{courier:"leopard"}));S.value=e.data.data}async function Be(){const e=await k.get(route("platforms.get"));Me.value=e.data.data}async function He(){const e=await k.get(route("materials.get"));U.value=e.data.data}async function $e(){const e=await k.get(route("vendors.get"));Ae.value=e.data.data}const Xe=e=>{const a=U.value.find(a=>a.id===e);return a?a.price:0},Ye=()=>{const e={id:qe.value.length+1,vendor_id:"",platform_id:"",item_name:"",purchase_cost:0,item_price:0,material_id:"",total_cost:0,profit:0,advance_payment:0};qe.value.push(e)},ze=e=>{qe.value=qe.value.filter(a=>a.id!==e),qe.value.forEach((e,a)=>{e.id=a+1}),0===qe.value.length&&Ye()},We=c(()=>qe.value.reduce((e,a)=>e+(a.purchase_cost||0),0)),Je=c(()=>qe.value.reduce((e,a)=>e+(a.item_price||0),0)),Qe=c(()=>qe.value.reduce((e,a)=>e+Xe(a.material_id),0)),Ze=c(()=>qe.value.reduce((e,a)=>e+(a.item_price||0),0)),ea=c(()=>qe.value.reduce((e,a)=>e+((a.item_price||0)-(a.purchase_cost||0)-Xe(a.material_id)),0)),aa=e=>new Intl.NumberFormat("en-PK",{minimumFractionDigits:0,maximumFractionDigits:0}).format(e);async function la(e){e.preventDefault(),Ee.value=!0;try{await k.post(route("courier.createOrder",{courier:"leopard"}),{destination_city:C.value,shipment_type:x[w.value][0][0],division:w.value,booked_packet_weight:Fe.value.weight,booked_packet_no_piece:Fe.value.pieces,booked_packet_collect_amount:Fe.value.cod_amount,order_id:Fe.value.order_id,consignee_name:Ge.value.name,consignee_phone:Ge.value.phone,consignee_address:Ge.value.address,advance_payment:Fe.value.advance_payment,special_instructions:Fe.value.special_instructions,vendor_id:Re.value,platform_id:Le.value,items:qe.value.map(e=>({item_name:e.item_name,platform_id:"1",purchase_cost:e.purchase_cost,item_price:e.item_price,material_id:e.material_id,advance_payment:"1"}))});successModalButton.click()}catch(a){}finally{Ee.value=!1}}function ta(){g.visit(route("booking.index"))}return u(async()=>{try{await Promise.all([Ke(),Be(),He(),$e()])}catch(e){}je.value=!1,r(()=>{$(".select2").select2({placeholder:"Select Destination City",allowClear:!0}),$("#destination_city").select2().on("change",e=>{C.value=$(e.target).val()})})}),m(C,e=>{}),m(Ne,e=>{}),(i,d)=>(a(),e(n,null,[d[47]||(d[47]=l("button",{"data-bs-toggle":"modal",id:"successModalButton","data-bs-target":"#successModal",style:{display:"none"}},"Testing",-1)),l("div",{class:"modal fade",id:"successModal",tabindex:"-1","aria-hidden":"true"},[l("div",{class:"modal-dialog modal-dialog-centered"},[l("div",{class:"modal-content p-4 text-center"},[l("div",{class:"modal-body"},[d[14]||(d[14]=b('<button type="button" class="btn-close position-absolute end-0 top-0 m-3" data-bs-dismiss="modal" aria-label="Close" data-v-cccad3d7></button><div class="text-success mb-3" data-v-cccad3d7><i class="bi bi-check-circle" style="font-size:3rem;" data-v-cccad3d7></i></div><h4 class="mb-2" data-v-cccad3d7>Shipment has been created</h4><p class="text-muted" data-v-cccad3d7>Your shipment was added successfully.</p>',4)),l("button",{type:"button",onClick:ta,class:"btn btn-success mt-3","data-bs-dismiss":"modal"},"Okay")])])])]),p(l("div",D,[l("form",{class:"card-body",method:"POST",onSubmit:la},[l("div",I,[d[17]||(d[17]=l("h5",{class:"card-header"},"Create New Order",-1)),d[18]||(d[18]=l("h6",null,"Order Detail",-1)),l("div",P,[_(V,{"onUpdate:modelValue":d[0]||(d[0]=e=>Fe.value.order_id=e),label:"Order ID",type:"text",length:4,name:"order_id",placeholder:"Order ID *"}),_(O,{label:"Division *",name:"division",length:4,nonvalueitem:"Select Division","onUpdate:modelValue":d[1]||(d[1]=e=>w.value=e),items:[["EXPRESS","EXPRESS"],["LOGISTICS","LOGISTICS"]],"value-key":"0","item-key":"1"}),_(O,{label:"Shipment Type *",name:"shipment_type",length:4,nonvalueitem:"Select Shipment Type",items:x[w.value],"value-key":"0","item-key":"1"},null,8,["items"])]),d[19]||(d[19]=l("hr",{class:"mx-n4 my-6"},null,-1)),d[20]||(d[20]=l("h6",null,"Customer Detail",-1)),l("div",T,[_(V,{"onUpdate:modelValue":d[2]||(d[2]=e=>Ge.value.name=e),label:"Consignee Name *",type:"text",name:"consignee_name",placeholder:"Consignee Name"}),_(V,{"onUpdate:modelValue":d[3]||(d[3]=e=>Ge.value.phone=e),label:"Consignee Phone *",type:"text",name:"consignee_phone",placeholder:"Consignee Phone"}),l("div",N,[l("div",E,[p(l("select",{"onUpdate:modelValue":d[4]||(d[4]=e=>C.value=e),name:"destination_city",id:"destination_city",class:"select2 form-select select2-hidden-accessible","data-allow-clear":"true",required:""},[d[15]||(d[15]=l("option",{value:""},"Select Destination City",-1)),(a(!0),e(n,null,s(S.value,l=>(a(),e("option",{value:l.id},t(l.city),9,A))),256))],512),[[h,C.value]]),d[16]||(d[16]=l("label",{for:"destination_city"},"Destination City *",-1))])]),_(O,{"onUpdate:modelValue":d[5]||(d[5]=e=>Le.value=e),label:"Platform *",name:"platform",length:6,nonvalueitem:"Select Platform",items:Me.value.map(e=>[e.id,e.name]),"value-key":"0","item-key":"1"},null,8,["items"]),_(V,{"onUpdate:modelValue":d[6]||(d[6]=e=>Ge.value.address=e),label:"Consignee Address *",type:"text",name:"consignee_address",placeholder:"Consignee Address",length:12})]),d[21]||(d[21]=l("hr",{class:"mx-n4 my-6"},null,-1)),d[22]||(d[22]=l("h6",null,"Shipment Detail",-1)),l("div",M,[_(V,{"onUpdate:modelValue":d[7]||(d[7]=e=>Fe.value.weight=e),label:"Weigh (grams) *",type:"text",length:4,name:"weight",placeholder:"Weight (grams) *"}),_(V,{"onUpdate:modelValue":d[8]||(d[8]=e=>Fe.value.pieces=e),label:"No. of Pieces *",type:"text",name:"pieces",length:4,placeholder:"No. of Pieces *"}),_(V,{"onUpdate:modelValue":d[9]||(d[9]=e=>Fe.value.product_description=e),label:"Product Description *",type:"text",name:"product_description",length:4,placeholder:"Product Description *"}),_(V,{"onUpdate:modelValue":d[10]||(d[10]=e=>Fe.value.cod_amount=e),label:"COD Amount *",type:"number",name:"cod_amount",placeholder:"COD Amount *"}),_(V,{"onUpdate:modelValue":d[11]||(d[11]=e=>Fe.value.advance_payment=e),label:"Advance Payment *",type:"number",name:"advance_payment",placeholder:"Advance Payment *"}),_(V,{"onUpdate:modelValue":d[12]||(d[12]=e=>Fe.value.special_instructions=e),label:"Special Instructions *",type:"text",name:"special_instructions",length:12,placeholder:"Handle with care *","is-text-area":""})])]),Te.value?(a(),e("div",j,[d[33]||(d[33]=l("h6",null,"3. Items Details",-1)),l("div",q,[l("table",G,[l("thead",{class:"table-light"},[l("tr",null,[d[23]||(d[23]=l("th",null,"Vendor",-1)),d[24]||(d[24]=l("th",null,"Product Name",-1)),d[25]||(d[25]=l("th",null,"Cost",-1)),d[26]||(d[26]=l("th",null,"Selling",-1)),d[27]||(d[27]=l("th",null,"Packaging Material",-1)),d[28]||(d[28]=l("th",null,"Total Amount",-1)),d[29]||(d[29]=l("th",null,"Profit",-1)),l("th",{style:{width:"64px"}},[l("button",{type:"button",class:"btn btn-sm btn-success",onClick:Ye},"+")])])]),l("tbody",null,[(a(!0),e(n,null,s(qe.value,o=>(a(),e("tr",{key:o.id},[l("td",null,[p(l("select",{"onUpdate:modelValue":e=>o.vendor_id=e,class:"form-select",required:""},[d[30]||(d[30]=l("option",{value:""},"Select Vendor",-1)),(a(!0),e(n,null,s(Ae.value,l=>(a(),e("option",{key:l.id,value:l.id},t(l.name),9,L))),128))],8,R),[[h,o.vendor_id]])]),l("td",null,[p(l("input",{type:"text","onUpdate:modelValue":e=>o.item_name=e,class:"form-control",required:""},null,8,F),[[f,o.item_name]])]),l("td",null,[p(l("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.purchase_cost=e,class:"form-control",required:""},null,8,K),[[f,o.purchase_cost,void 0,{number:!0}]])]),l("td",null,[p(l("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.item_price=e,class:"form-control",required:""},null,8,B),[[f,o.item_price,void 0,{number:!0}]])]),l("td",null,[p(l("select",{"onUpdate:modelValue":e=>o.material_id=e,class:"form-select",required:""},[d[31]||(d[31]=l("option",{value:""},"Select Material",-1)),(a(!0),e(n,null,s(U.value,l=>(a(),e("option",{key:l.id,value:l.id},t(l.name),9,X))),128))],8,H),[[h,o.material_id]])]),l("td",null,[l("input",{type:"number",value:o.item_price,class:"form-control",readonly:""},null,8,Y)]),l("td",null,[l("input",{type:"number",value:parseInt(o.item_price-o.purchase_cost)-Xe(o.material_id),class:"form-control",readonly:""},null,8,z)]),l("td",null,[l("button",{type:"button",class:"btn btn-sm btn-danger",onClick:e=>ze(o.id)},"-",8,W)])]))),128)),l("tr",J,[d[32]||(d[32]=l("td",{class:"totals-label"},[l("strong",null,"Total")],-1)),l("td",Q,[l("strong",null,t(qe.value.length)+" Items",1)]),l("td",Z,[l("strong",null,t(aa(We.value)),1)]),l("td",ee,[l("strong",null,t(aa(Je.value)),1)]),l("td",ae,[l("strong",null,t(aa(Qe.value)),1)]),l("td",le,[l("strong",null,t(aa(Ze.value)),1)]),l("td",te,[l("strong",{class:o({"text-danger":ea.value<0,"text-success":ea.value>0})},t(aa(ea.value)),3)]),l("td",ne,[l("strong",null,t(Je.value>0?(ea.value/Je.value*100).toFixed(1):0)+"%",1)])])])])])])):v("",!0),Te.value?(a(),e("div",se,[l("div",{class:"d-flex align-items-center justify-content-between mb-2"},[d[34]||(d[34]=l("h6",{class:"mb-0"},"Items",-1)),l("button",{type:"button",class:"btn btn-sm btn-success",onClick:Ye},"Add")]),(a(!0),e(n,null,s(qe.value,o=>(a(),e("div",{key:"m-"+o.id,class:"item-card mb-3"},[l("div",oe,[l("strong",null,"#"+t(o.id),1),l("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>ze(o.id)},"Remove",8,ie)]),l("div",de,[l("div",ce,[d[36]||(d[36]=l("label",{class:"form-label"},"Vendor",-1)),p(l("select",{"onUpdate:modelValue":e=>o.vendor_id=e,class:"form-select",required:""},[d[35]||(d[35]=l("option",{value:""},"Select Vendor",-1)),(a(!0),e(n,null,s(Ae.value,l=>(a(),e("option",{key:l.id,value:l.id},t(l.name),9,re))),128))],8,ue),[[h,o.vendor_id]])]),l("div",me,[d[37]||(d[37]=l("label",{class:"form-label"},"Product Name",-1)),p(l("input",{type:"text","onUpdate:modelValue":e=>o.item_name=e,class:"form-control",placeholder:"e.g. T-Shirt",required:""},null,8,pe),[[f,o.item_name]])]),l("div",ve,[d[38]||(d[38]=l("label",{class:"form-label"},"Cost",-1)),p(l("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.purchase_cost=e,class:"form-control"},null,8,be),[[f,o.purchase_cost,void 0,{number:!0}]])]),l("div",ye,[d[39]||(d[39]=l("label",{class:"form-label"},"Selling",-1)),p(l("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.item_price=e,class:"form-control"},null,8,_e),[[f,o.item_price,void 0,{number:!0}]])]),l("div",he,[d[41]||(d[41]=l("label",{class:"form-label"},"Packaging Material",-1)),p(l("select",{"onUpdate:modelValue":e=>o.material_id=e,class:"form-select"},[d[40]||(d[40]=l("option",{value:""},"Select Material",-1)),(a(!0),e(n,null,s(U.value,l=>(a(),e("option",{key:l.id,value:l.id},t(l.name),9,fe))),128))],8,ge),[[h,o.material_id]])]),l("div",Ve,[d[42]||(d[42]=l("label",{class:"form-label"},"Total",-1)),l("input",{type:"number",value:o.item_price,class:"form-control",readonly:""},null,8,ke)]),l("div",Se,[d[43]||(d[43]=l("label",{class:"form-label"},"Profit",-1)),l("input",{type:"number",value:parseInt(o.item_price-o.purchase_cost)-Xe(o.material_id),class:"form-control",readonly:""},null,8,Ce)]),l("div",xe,[d[44]||(d[44]=l("label",{class:"form-label"},"Advance Payment",-1)),p(l("input",{type:"number",step:"0.01","onUpdate:modelValue":e=>o.advance_payment=e,class:"form-control"},null,8,Ue),[[f,o.advance_payment,void 0,{number:!0}]])])])]))),128))])):v("",!0),l("div",we,[l("button",{disabled:Ee.value,type:"submit",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px"}},[Ee.value?(a(),e("span",De)):(a(),e("span",Ie,"Book Order"))],8,Oe),l("a",{onClick:d[13]||(d[13]=e=>Te.value=!Te.value),type:"cancel",class:"btn btn-primary waves-effect waves-light d-flex align-items-center justify-content-center me-4",style:{"min-width":"120px",color:"white"}},t(Te.value?"Hide":"Show")+" Chart ",1),d[45]||(d[45]=l("button",{type:"reset",class:"btn btn-outline-secondary waves-effect me-4"},"Cancel",-1))])],32)],512),[[y,!je.value]]),je.value?(a(),e("div",Pe,d[46]||(d[46]=[l("span",{class:"spinner"},null,-1)]))):v("",!0)],64))}}),[["__scopeId","data-v-cccad3d7"]]);export{Te as default};
